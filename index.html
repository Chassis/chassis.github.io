<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chassis by Chassis</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/Chassis">View On GitHub</a></li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Chassis</h1>
          <p></p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/Chassis">Chassis</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="sennza-chassis" class="anchor" href="#sennza-chassis"><span class="octicon octicon-link"></span></a>Sennza Chassis</h1>

<p>This is the new fangled base repository for Sennza work.</p>

<h2>
<a name="prerequisites" class="anchor" href="#prerequisites"><span class="octicon octicon-link"></span></a>Prerequisites</h2>

<p>Before using Chassis, this is how your system should be set up:</p>

<ul>
<li>Install <a href="http://vagrantup.com/">Vagrant</a>
</li>
<li>
<p>Install vagrant-hostsupdater to access via <code>vagrant.local</code>:</p>

<pre><code>vagrant plugin install vagrant-hostsupdater
</code></pre>

<p><strong>Note for Windows users:</strong> You'll need to set
<code>C:\Windows\system32\drivers\etc\hosts</code> to be writable by your user. Simply
head to the properties and add your user with full control under security.</p>

<p>Alternatively, add <code>vagrant.local</code> to your hosts file with <code>192.168.33.10</code> as
the IP address.</p>
</li>
</ul><h2>
<a name="using" class="anchor" href="#using"><span class="octicon octicon-link"></span></a>Using</h2>

<div class="highlight highlight-bash"><pre><span class="c"># Clone this repo</span>
git clone --recursive git@github.com:sennza/Chassis.git myproject
<span class="c"># If you forget --recursive:</span>
<span class="c"># git submodule update --init</span>

<span class="nb">cd </span>myproject

<span class="c"># Clone the content/ directory!</span>
<span class="c"># git clone git@github.com:sennza/myproject.git content</span>

<span class="c"># Use https://github.com/sennza/wp-content as a base, and follow the</span>
<span class="c"># instructions there.</span>

<span class="c"># Boot up a VM</span>
vagrant up
</pre></div>

<p>Make sure you copy <code>local-config-sample.php</code> to <code>local-config.php</code></p>

<h2>
<a name="working-with-the-vm" class="anchor" href="#working-with-the-vm"><span class="octicon octicon-link"></span></a>Working with the VM</h2>

<div class="highlight highlight-bash"><pre><span class="c"># Start the VM</span>
vagrant up

<span class="c"># SSH in to the VM</span>
vagrant ssh

<span class="c"># Reprovisioning (e.g. after updating this repository)</span>
vagrant provision

<span class="c"># Reprovisioning without a full apt-get update</span>
vagrant provision --provision-with puppet

<span class="c"># Suspending (sleeping) the VM</span>
<span class="c"># Note that this doesn't remove the hosts entry</span>
vagrant <span class="nb">suspend</span>

<span class="c"># Halting (shutting down) the VM</span>
vagrant halt

<span class="c"># Destroying the VM (if your VM is completely broken)</span>
vagrant destroy
</pre></div>

<h2>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>Chassis contains a flexible configuration setup, allowing you flexibility in
overriding the defaults. Chassis follows the following loading procedure:</p>

<ul>
<li>
<code>content/config.local.yaml</code> (project-specific overrides)</li>
<li>
<code>content/config.yaml</code> (project-specific defaults)</li>
<li>
<code>config.local.yaml</code> (global overrides)</li>
<li>
<code>config.yaml</code> (global defaults)</li>
</ul><h3>
<a name="multisite" class="anchor" href="#multisite"><span class="octicon octicon-link"></span></a>Multisite</h3>

<p>Chassis has full support for running WordPress in multisite mode. Here's what
you need to do to enable it:</p>

<ol>
<li>Add <code>multisite: Yes</code> to your <code>config.local.yaml</code> or project configuration.</li>
<li>
<p>Provision your VM!</p>

<p>(Note: due to <a href="https://github.com/sennza/Chassis/issues/32">a bug</a>, you need to destroy and recreate an
already-provisioned VM. We're working on fixing this.)</p>
</li>
</ol><p>That's it!</p>

<h3>
<a name="adding-real-domains" class="anchor" href="#adding-real-domains"><span class="octicon octicon-link"></span></a>Adding "Real" Domains</h3>

<p>We've realized internally that using vagrant.local doesn't always cut it for
development, as you may need to use a different domain for testing. Thankfully
we can fake it 'til we make it by overriding the default configuration.</p>

<ol>
<li>
<p>Add your hosts to your YAML configuration. We recommend using your
project-specific configuration (<code>content/config.yaml</code>), since it's part of
the site's configuration.</p>

<div class="highlight highlight-yaml"><pre><span class="l-Scalar-Plain">hosts</span><span class="p-Indicator">:</span>
   <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">vagrant.local</span>
   <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">example.sennza.com.au</span>
</pre></div>

<p>(The first host in the list will be used as the machine's name. We recommend
leaving this as <code>vagrant.local</code> for the most part.)</p>
</li>
<li><p>Reboot your VM (<code>vagrant reload</code>)</p></li>
</ol><h3>
<a name="mysql-database" class="anchor" href="#mysql-database"><span class="octicon octicon-link"></span></a>MySQL Database</h3>

<p>Your database can be configured completely via the YAML configuration. This is
where the YAML hierarchy is most useful:</p>

<ul>
<li>
<code>config.yaml</code> contains the default (User <code>wordpress</code>, password <code>vagrantpassword</code>)</li>
<li>
<code>config.local.yaml</code> can contain your "real" database details. These can be
generated by a deployment script, such as Capistrano.</li>
</ul><h2>
<a name="updating" class="anchor" href="#updating"><span class="octicon octicon-link"></span></a>Updating</h2>

<div class="highlight highlight-bash"><pre><span class="c"># Pull and rebase (in case you have project-specific commits)</span>
git pull --rebase

<span class="c">## Update submodules (Puppet modules and WP)</span>
git submodule update --init
</pre></div>

<h2>
<a name="update-your-submodules" class="anchor" href="#update-your-submodules"><span class="octicon octicon-link"></span></a>Update Your Submodules</h2>

<p>Sometimes we have to change the submodules because a repository isn't being
regularly maintained. e.g. <a href="https://github.com/sennza/Chassis/issues/5">Use Puppet Labs's apt module</a>.
When this happens you'll probably get confused by submodules so here are the
commands you need to run to get your submodules up to date again.</p>

<pre><code>git submodule sync
cd puppet/modules/apt
git checkout master
git pull

# Ensure your VM is up-to-date
vagrant provision
</code></pre>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>